-- Geração de Modelo físico
-- Sql ANSI 2003 - brModelo.

CREATE DATABASE Webfono


CREATE TABLE Venda (
id_venda int PRIMARY KEY AUTO_INCREMENT,
data timestamp,
total_venda float,
id_produto int,
id_paciente int
);

CREATE TABLE Produto (
id_produto int PRIMARY KEY AUTO_INCREMENT,
nome_produto Varchar(60),
descricao Varchar(150),
quantidade int,
preco float,
foto_produto Longblob
);

CREATE TABLE Paciente (
id_paciente int PRIMARY KEY AUTO_INCREMENT,
nome_paciente Varchar(60),
cpf Varchar(16),
RG Varchar(16),
email Varchar(70),
nascimento date,
telefone char(14),
endereco Varchar(80),
bairro Varchar(30),
cidade Varchar(40),
cep Char(9),
UNIQUE (cpf),
UNIQUE (RG)
);

CREATE TABLE Atendimento (
id_atendimento int PRIMARY KEY AUTO_INCREMENT,
data date,
descricao Varchar(150),
hora time,
id_paciente int
);

CREATE TABLE login (
id_login int PRIMARY KEY AUTO_INCREMENT,
usuario Varchar(50),
email varchar(90),
senha Varchar(255)
);

CREATE TABLE ProdutoPaciente (
    id_produto_paciente int PRIMARY KEY AUTO_INCREMENT,
    id_produto int,
    id_paciente int,
    status Varchar(30),
    data_inicio date,
    data_fim date, -- Pode ser NULL se o produto foi comprado
    FOREIGN KEY (id_produto) REFERENCES Produto (id_produto),
    FOREIGN KEY (id_paciente) REFERENCES Paciente (id_paciente)
);

ALTER TABLE Venda ADD FOREIGN KEY(id_produto) REFERENCES Produto (id_produto);
ALTER TABLE Venda ADD FOREIGN KEY(id_paciente) REFERENCES Paciente (id_paciente);
ALTER TABLE Atendimento ADD FOREIGN KEY(id_paciente) REFERENCES Paciente (id_paciente)

